# Ml_shift
В данном репозитории представлено решение вступительного задания на участие в [проекте ШИФТ по направлению ML](https://team.cft.ru/start/school/ml)

[Страница соревнования "Турникеты"](https://codalab.lisn.upsaclay.fr/competitions/17067?secret_key=8706c18f-4eec-4e47-9279-a535d7da0f99)

## Оглавление  
[1. Описание проекта](README.md#Описание-проекта)

[2. Краткая информация о данных](README.md#Краткая-информация-о-данных)

[3. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)

[4. Выводы](README.md#Выводы) 

### Описание проекта  

Предскажите, кто вошел в здание по времени и турникету. Мы знаем, что "след" через турникеты принадлежит "Х". Кто этот "Х" предстоит вычислить по данным, которые нам известны. А ID юзеров известны по обучающей выборке (кроме нескольких новых!).

Чтобы попасть в здание, нужно пройти через турникет. Чтобы открыть парковку, нужно открыть шлагбаум. Чтобы попасть на этаж, нужно приложить “таблетку”. Все это фиксируется - кто, в какую дату, в какое время.
Сможем ли мы выучить кому конкретно принадлежит след прохода через турникеты? Мы знаем, что это был кто-то, кто уже был. (Правда, есть и несколько - не больше 10% - новых).

В тестовой выборке id посетителей заменены на слова: aucroc, binary, blue, categorical и т.п.
Задача - составить таблицу вида:

user_word	preds
aucroc	49
binary	12
...	…
где user_word - index, preds - колонка с соответствующими id. 
-999 – id нового посетителя, которого раньше не было.

Каждому слову сопоставлен вес, который зависит от того, насколько трудно предсказать id. Баллы набираются как взвешенная по весам сумма правильных ответов. Чем сложнее вы отгадали слово, тем больше баллов.

:arrow_up:[к оглавлению](README.md#Оглавление)

### Краткая информация о данных
Тренировочные данные содержат 37518 строк, для каждой строки
 - 'user_id' - id пользователя (всего 56 уникальных пользователей),
 - 'ts' - дата и время фиксации наблюдения,
 - 'gate_id' - id гейта (17 уникальных гейтов),

Период наблюдений в тренировочных данных: с 29-07-2022 по 31-12-2022 (5 месяцев), в тесте: с 03-01-2023 по 24-02-2023.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Этапы работы над проектом  
1. Загрузка и предобработка данных.
2. EDA + Feature engineering.
3. Построение модели градиентного бустинга (CatBoost).
4. Предсказание для тестовой выборки и подготовка сабмита.

:arrow_up:[к оглавлению](README.md#Оглавление)


### Выводы:  
- Представленное здесь решение получило 4 место на лидерборде и 358 баллов.
- Наибольший прирост дали новые фичи: временные лаги гейта и времени прохода, а также значение часа и гейта для первого и последнего прохода за день. 
- Мультиклассификатор для предсказания id пользователя показал качество accuracy около 0.4 в среднем при кросс-валидации на 5 фолдов.

:arrow_up:[к оглавлению](README.md#Оглавление)


Если информация по этому проекту покажется вам интересной или полезной, то я буду очень вам благодарна, если отметите репозиторий и профиль ⭐️⭐️⭐️-дами
